


Почтовое взаимодействие с внешними системами  
=======================================================


.. table:: Набор команд для взаимодействия с почтовой системой Заказчика представлен

    +-----------------+-----------------+-------------------------------------------+
    |     Команда     |  Обязательность |                 Описание                  |
    +=================+=================+===========================================+
    |       HELO      |   Обязательна   | Идентифицирует модуль-передатчик для      | 
    |                 |                 | модуля-приемника (hello)                  |
    +-----------------+-----------------+-------------------------------------------+
    |       MAIL      |   Обязательна   | Начинает почтовую транзакцию, которая     |
    |                 |                 | завершается передачей данных в один или   |
    |                 |                 | несколько почтовых ящиков (mail).         |
    +-----------------+-----------------+-------------------------------------------+
    |       RCPT      |   Обязательна   | Идентифицирует получателя почтового       |
    |                 |                 | сообщения (recipient)                     |
    +-----------------+-----------------+-------------------------------------------+
    |       DATA      |  Не обязательна | Строки, следующие за этой командой,       |
    |                 |                 | рассматриваются получателем как данные    |
    |                 |                 | почтового сообщения. В случае SMTP,       |
    |                 |                 | почтовое сообщение заканчивается          |
    |                 |                 | комбинацией символов: CRLF-точка-CRLF     |
    +-----------------+-----------------+-------------------------------------------+
    |       RSET      |  Не обязательна | Прерывает текущую почтовую транзакцию     |
    +-----------------+-----------------+-------------------------------------------+
    |       NOOP      |  Не обязательна | Требует от получателя не предпринимать    |
    |                 |                 | никаких действий, а только выдать         |
    |                 |                 | ответ ОК. Используется главным образом для|
    |                 |                 | тестирования.(No operation)               |
    +-----------------+-----------------+-------------------------------------------+
    |       QUIT      |  Не обязательна | Требует выдать ответ ОК и закрыть текущее |
    |                 |                 | соединение                                |
    +-----------------+-----------------+-------------------------------------------+
    |       VRFY      |  Не обязательна | Требует от приемника подтвердить, что ее  |
    |                 |                 | аргумент является действительным именем   |
    |                 |                 | пользователя.                             |
    +-----------------+-----------------+-------------------------------------------+
    |       SEND      |  Не обязательна | Начинает почтовую транзакцию, доставляющую|
    |                 |                 | данные на один или несколько терминалов   |
    |                 |                 | (а не в почтовый ящик)                    | 
    +-----------------+-----------------+-------------------------------------------+
    |       SOML      |  Не обязательна | Начинает транзакцию MAIL или SEND,        |
    |                 |                 | доставляющую данные на один или несколько |
    |                 |                 | терминалов или в почтовые ящики           |
    +-----------------+-----------------+-------------------------------------------+
    |       SAML      |  Не обязательна | Начинает транзакцию MAIL и SEND,          |
    |                 |                 | доставляющие данные на один или несколько | 
    |                 |                 | терминалов и в почтовые ящики             |
    +-----------------+-----------------+-------------------------------------------+
    |       EXPN      |  Не обязательна | Команда SMTP-приемнику подтвердить,       |
    |                 |                 | действительно ли аргумент является адресом| 
    |                 |                 | почтовой рассылки и если да, вернуть адрес| 
    |                 |                 | получателя сообщения (expand)             |
    +-----------------+-----------------+-------------------------------------------+
    |       HELP      |  Не обязательна | Команда SMTP-приемнику вернуть            |
    |                 |                 | сообщение-справку о его командах          |
    +-----------------+-----------------+-------------------------------------------+
    |       TURN      |  Не обязательна | Команда SMTP-приемнику либо сказать ОК и  |
    |                 |                 | поменяться ролями, то есть стать STMP-    |
    |                 |                 | передатчиком, либо послать сообщение-отказ| 
    |                 |                 | и остаться в роли SMTP-приемника          |
    +-----------------+-----------------+-------------------------------------------+    


Согласно протоколу SMTP, сервер передачи электронных сообщений отвечает на каждую команду. 

.. table:: Состав данных элемента Е12 ЕФРТ (информация о финансовой гарантии)

    +-----------------+-------------------------------------------+
    |       Код       |                 Значение                  |
    +=================+===========================================+
    |       211       |   Ответ о состоянии системы или помощь    |
    +-----------------+-------------------------------------------+
    |       214       |       Сообщение-подсказка (помощь)        |
    +-----------------+-------------------------------------------+
    |       220       |    <имя_домена> служба готова к работе    |
    +-----------------+-------------------------------------------+
    |       221       | <имя_домена> служба закрывает канал связи |
    +-----------------+-------------------------------------------+
    |       250       | Запрошенное действие почтовой             |
    |                 | транзакции успешно завершилось            |
    +-----------------+-------------------------------------------+
    |       251       | Данный адресат не является местным;       |
    |                 | сообщение будет передано по маршруту      |
    |                 | <forward-path>                            |
    +-----------------+-------------------------------------------+
    |       354       | Начинай передачу сообщения. Сообщение     |
    |                 | заканчивается комбинацией CRLF-точка-CRLF |
    +-----------------+-------------------------------------------+
    |       421       | <имя_домена> служба недоступна;           |
    |                 | соединение закрывается                    |
    +-----------------+-------------------------------------------+
    |       450       | Запрошенная команда почтовой транзакции   |
    |                 | не выполнена, так как почтовый            |
    |                 | ящик недоступен                           |
    +-----------------+-------------------------------------------+
    |       451       | Запрошенная команда не выполнена;         |
    |                 | произошла локальная ошибка при            |
    |                 | обработке сообщения                       |
    +-----------------+-------------------------------------------+
    |       452       | Запрошенная команда не выполнена;         |
    |                 | системе не хватило ресурсов               |
    +-----------------+-------------------------------------------+
    |       500       | Синтаксическая ошибка в тексте команды;   |
    |                 | команда не опознана                       |
    +-----------------+-------------------------------------------+
    |       501       | Синтаксическая ошибка в аргументах        |
    |                 | или параметрах команды                    |
    +-----------------+-------------------------------------------+
    |       502       | Данная команда не реализована             |
    +-----------------+-------------------------------------------+
    |       503       | Неверная последовательность команд        |
    +-----------------+-------------------------------------------+
    |       504       | У данной команды не может быть аргументов |
    +-----------------+-------------------------------------------+
    |       550       | Запрошенная команда не выполнена,         |
    |                 | так как почтовый ящик недоступен          |
    +-----------------+-------------------------------------------+
    |       551       | Данный адресат не является местным;       |
    |                 | попробуйте передать сообщение по маршруту | 
    |                 | <forward-path>                            |
    +-----------------+-------------------------------------------+
    |       552       | Запрошенная команда почтовой транзакции   |
    |                 | прервана; дисковое пространство,          |
    |                 | доступное системе, переполнилось          |
    +-----------------+-------------------------------------------+
    |       553       | Запрошенная команда не выполнена;         |
    |                 | указано недопустимое имя почтового ящика  |
    +-----------------+-------------------------------------------+
    |       554       | Транзакция не выполнена                   |
    +-----------------+-------------------------------------------+


